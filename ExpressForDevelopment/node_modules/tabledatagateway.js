var queries = require('queries.js');

var getDBPromis = function(){
  var credentials = require('dbconfig.js');
  var pgp = require('pg-promise')();
  var db = pgp(credentials.url);
  return db;
}

var db = getDBPromis();

exports.selectVersicherungOf = function(personID, onSuccess, onError){
  var query = queries.selectVersicherungOf;
  db.any(query,personID).then(onSuccess).catch(onError);
}

exports.selectVersicherung = function(versicherungID, onSuccess, onError){
  var query = queries.selectVersicherung;
  db.any(query,versicherungID).then(onSuccess).catch(onError);
}

exports.erstelleVersicherung = function(personID, name, versicherungshoehe, beitrag, beschreibung, onSuccess, onError){
  var query = queries.insertVersicherung;
  db.any(query, [personID, name, versicherungshoehe, beitrag, beschreibung]).then(onSuccess).catch(onError);
}

exports.erstelleInvestition = function(versicherungID, personID, betrag, onSuccess, onError){
  var query = queries.tranInvestieren;
  db.any(query, [versicherungID,personID,betrag]).then(onSuccess).catch(onError);
}

exports.selectInvestitionOf = function(personID, onSuccess, onError){
  var query = queries.selectInvestitionOf;
  db.any(query,personID).then(onSuccess).catch(onError);
}

exports.selectInvestitionen = function(versicherungID, onSuccess, onError){
  var query = queries.selectInvestitionen;
  db.any(query,versicherungID).then(onSuccess).catch(onError);
}

exports.selectInvestition = function(investitionID, onSuccess, onError){
  var query = queries.selectInvestition;
  db.any(query,investitionID).then(onSuccess).catch(onError);
}

exports.selectInvestorenVonVersicherung = function(versicherungID, onSuccess, onError){
  var query = queries.selectInvestorenVonVersicherung;
  db.any(query,versicherungID).then(onSuccess).catch(onError);
}

exports.selectInvestitionsSumVonVersicherung = function(versicherungID, onSuccess, onError){
  var query = queries.selectInvestitionsSumVonVersicherung;
  db.any(query,versicherungID).then(onSuccess).catch(onError);
}

exports.getPaymentrelevantInvestitions = function(onSuccess, onError){
  var query = queries.getPaymentrelevantInvestitions;
  db.any(query).then(onSuccess).catch(onError);
}
